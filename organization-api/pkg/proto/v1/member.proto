syntax = "proto3";

package organization.v1;

import "buf/validate/validate.proto";
import "google/protobuf/empty.proto";
import "google/protobuf/timestamp.proto";
import "v1/common.proto";

option go_package = "github.com/fundament-oss/fundament/organization-api/pkg/proto/gen/v1;organizationv1";

// MemberService manages organization members
service MemberService {
  // List all members of the current organization
  rpc ListMembers(ListMembersRequest) returns (ListMembersResponse);
  // Delete a member from the organization
  rpc DeleteMember(DeleteMemberRequest) returns (DeleteMemberResponse);
  // Update a member's role
  rpc UpdateMemberRole(UpdateMemberRoleRequest) returns (google.protobuf.Empty);
}

// List members request
message ListMembersRequest {}

// List members response
message ListMembersResponse {
  repeated Member members = 10;
}

// Delete member request
message DeleteMemberRequest {
  string id = 10 [(buf.validate.field).string = {uuid: true}];
}

// Delete member response
message DeleteMemberResponse {}

// Update member role request
message UpdateMemberRoleRequest {
  string id = 10 [(buf.validate.field).string = {uuid: true}];
  string role = 20 [(buf.validate.field).string = {
    in: [
      "viewer",
      "admin"
    ]
  }];
}

// Member information
message Member {
  string id = 10;
  string name = 20;
  // external_ref is empty for pending invitations
  optional string external_ref = 30;
  // email is set for invited members
  optional string email = 50;
  // permission is "viewer" or "admin"
  string permission = 60;
  // status is "pending", "accepted", "declined", or "revoked"
  string status = 70;
  google.protobuf.Timestamp created = 40;
}
