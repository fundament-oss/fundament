// This file is auto-generated by @hey-api/openapi-ts

import type { Client, Options as Options2, TDataShape } from '@hey-api/client-fetch';

import { client } from './client.gen';
import type { HandleCallbackData, HandleCallbackErrors, HandleLoginData, HandleLoginErrors, HandleLogoutData, HandleLogoutErrors, HandleLogoutResponses, HandlePasswordLoginData, HandlePasswordLoginErrors, HandlePasswordLoginResponses, HandleRefreshData, HandleRefreshErrors, HandleRefreshResponses } from './types.gen';

export type Options<TData extends TDataShape = TDataShape, ThrowOnError extends boolean = boolean> = Options2<TData, ThrowOnError> & {
    /**
     * You can provide a client instance returned by `createClient()` instead of
     * individual options. This might be also useful if you want to implement a
     * custom client.
     */
    client?: Client;
    /**
     * You can pass arbitrary values through the `meta` object. This can be
     * used to access values that aren't defined as part of the SDK function.
     */
    meta?: Record<string, unknown>;
};

/**
 * Initiate OIDC login flow
 *
 * Initiates the OIDC login flow by redirecting to the configured identity provider.
 * Stores state and PKCE verifier in session cookie for security.
 *
 */
export const handleLogin = <ThrowOnError extends boolean = false>(options?: Options<HandleLoginData, ThrowOnError>) => (options?.client ?? client).get<unknown, HandleLoginErrors, ThrowOnError>({ url: '/login', ...options });

/**
 * Password-based login
 *
 * Authenticates a user using email and password credentials.
 * Uses the OIDC provider's password grant flow.
 *
 */
export const handlePasswordLogin = <ThrowOnError extends boolean = false>(options: Options<HandlePasswordLoginData, ThrowOnError>) => (options.client ?? client).post<HandlePasswordLoginResponses, HandlePasswordLoginErrors, ThrowOnError>({
    url: '/login/password',
    ...options,
    headers: {
        'Content-Type': 'application/json',
        ...options.headers
    }
});

/**
 * OIDC callback handler
 *
 * Handles the redirect from the OIDC provider after authentication.
 * Exchanges the authorization code for tokens, creates/updates the user in the database,
 * and sets the authentication cookie.
 *
 */
export const handleCallback = <ThrowOnError extends boolean = false>(options: Options<HandleCallbackData, ThrowOnError>) => (options.client ?? client).get<unknown, HandleCallbackErrors, ThrowOnError>({ url: '/callback', ...options });

/**
 * Refresh JWT token
 *
 * Refreshes the JWT token using the current valid token from cookie or Authorization header.
 * Returns a new token with extended expiry.
 *
 */
export const handleRefresh = <ThrowOnError extends boolean = false>(options?: Options<HandleRefreshData, ThrowOnError>) => (options?.client ?? client).post<HandleRefreshResponses, HandleRefreshErrors, ThrowOnError>({
    security: [{
            in: 'cookie',
            name: 'fundament_auth',
            type: 'apiKey'
        }, { scheme: 'bearer', type: 'http' }],
    url: '/refresh',
    ...options
});

/**
 * Logout user
 *
 * Clears the authentication cookie to log out the user.
 */
export const handleLogout = <ThrowOnError extends boolean = false>(options?: Options<HandleLogoutData, ThrowOnError>) => (options?.client ?? client).post<HandleLogoutResponses, HandleLogoutErrors, ThrowOnError>({ url: '/logout', ...options });
