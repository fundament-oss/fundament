<!-- Header -->
<div class="border-b border-gray-200 px-6 py-4 dark:border-gray-800">
  <h1 class="text-2xl font-bold dark:text-white">Cluster summary</h1>
  <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">
    Review your cluster configuration before creating it.
  </p>
</div>

<!-- Summary Content -->
<div class="space-y-6 px-6 py-6">
  <!-- Basics Block -->
  <div class="rounded-md border border-gray-200 p-4 dark:border-gray-800">
    <h3 class="mb-4 text-lg font-medium dark:text-white">Basics</h3>
    <div class="grid grid-cols-1 gap-4 sm:grid-cols-3">
      <dl>
        <dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Cluster name</dt>
        <dd class="mt-1 text-sm dark:text-white">{{ state().clusterName || 'N/A' }}</dd>
      </dl>
      <dl>
        <dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Region</dt>
        <dd class="mt-1 text-sm dark:text-white">{{ state().region?.toUpperCase() || 'N/A' }}</dd>
      </dl>
      <dl>
        <dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Kubernetes version</dt>
        <dd class="mt-1 text-sm dark:text-white">
          {{ state().kubernetesVersion || 'N/A' }}
        </dd>
      </dl>
    </div>
  </div>

  <!-- Node Pools Block -->
  <div class="rounded-md border border-gray-200 p-4 dark:border-gray-800">
    <h3 class="mb-4 text-lg font-medium dark:text-white">Node pools</h3>
    @if (state().nodePools && state().nodePools!.length > 0) {
      <div class="space-y-4">
        @for (nodePool of state().nodePools; track nodePool.name) {
          <div
            class="rounded-md border border-gray-200 bg-gray-50 p-3 dark:border-gray-800 dark:bg-gray-900"
          >
            <h4 class="mb-3 text-sm font-medium dark:text-white">{{ nodePool.name }}</h4>
            <div class="grid grid-cols-1 gap-3 sm:grid-cols-3">
              <dl>
                <dt class="text-xs font-medium text-gray-500 dark:text-gray-400">Machine type</dt>
                <dd class="mt-1 text-sm dark:text-white">{{ nodePool.machineType }}</dd>
              </dl>
              <dl>
                <dt class="text-xs font-medium text-gray-500 dark:text-gray-400">
                  Min autoscaling
                </dt>
                <dd class="mt-1 text-sm dark:text-white">{{ nodePool.autoscaleMin }} nodes</dd>
              </dl>
              <dl>
                <dt class="text-xs font-medium text-gray-500 dark:text-gray-400">
                  Max autoscaling
                </dt>
                <dd class="mt-1 text-sm dark:text-white">{{ nodePool.autoscaleMax }} nodes</dd>
              </dl>
            </div>
          </div>
        }
      </div>
    } @else {
      <p class="text-sm text-gray-500 dark:text-gray-400">No node pools configured</p>
    }
  </div>

  <!-- Plugins Block -->
  <div class="rounded-md border border-gray-200 p-4 dark:border-gray-800">
    <h3 class="mb-4 text-lg font-medium dark:text-white">Plugins</h3>
    @if (state().preset || (state().plugins && state().plugins!.length > 0)) {
      <div class="space-y-2">
        @if (state().preset) {
          <dl>
            <dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Preset</dt>
            <dd class="mt-1 text-sm dark:text-white">{{ state().preset }}</dd>
          </dl>
        }
        @if (state().plugins && state().plugins!.length > 0) {
          <dl>
            <dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Selected plugins</dt>
            <dd class="mt-2 flex flex-wrap gap-1">
              @for (plugin of state().plugins; track plugin) {
                <span
                  class="inline-flex items-center rounded-md bg-emerald-100 px-2 py-1 text-xs font-medium text-emerald-800 dark:bg-emerald-950 dark:text-emerald-200"
                >
                  {{ plugin }}
                </span>
              }
            </dd>
          </dl>
        }
      </div>
    } @else {
      <p class="text-sm text-gray-500 dark:text-gray-400">No plugins configured</p>
    }
  </div>

  <!-- Error Message -->
  @if (errorMessage()) {
    <div class="flex items-center rounded-md bg-rose-50 p-4 dark:bg-rose-900/20">
      <app-error-icon class="mr-3 h-5 w-5 shrink-0 text-rose-400 dark:text-rose-500" />
      <p class="text-sm font-medium text-rose-800 dark:text-rose-200">{{ errorMessage() }}</p>
    </div>
  } @else {
    <!-- Creation Notice -->
    <div
      class="rounded-md border border-blue-200 bg-blue-50 p-4 dark:border-indigo-800 dark:bg-indigo-950"
    >
      <div class="mb-2 flex">
        <app-info-circle-icon class="mr-2 h-5 w-5 shrink-0 text-blue-400 dark:text-indigo-400" />
        <h3 class="text-sm font-medium text-blue-800 dark:text-indigo-300">Cluster creation</h3>
      </div>
      <div class="text-sm text-blue-700 dark:text-indigo-200">
        <p>
          Creating your cluster will take approximately 1-5 minutes. Keep this page open to view the
          progress.
        </p>
      </div>
    </div>
  }

  <!-- Form Actions -->
  <div class="flex space-x-3 border-t border-gray-200 pt-6 dark:border-gray-800">
    <a
      routerLink="/add-cluster/plugins"
      class="btn-secondary"
      [class.pointer-events-none]="isCreating()"
      [class.opacity-50]="isCreating()"
      >Previous step</a
    >
    <button type="button" (click)="onCreateCluster()" class="btn-primary" [disabled]="isCreating()">
      {{ isCreating() ? 'Creating...' : 'Create cluster' }}
    </button>
  </div>
</div>
