<app-modal
  [show]="show"
  [title]="isEditMode ? 'Edit permission' : 'Add permission'"
  (modalClose)="onClose()"
>
  @if (!isEditMode) {
    <div>
      <label for="user-select" class="mb-1 block text-sm font-medium dark:text-white">User</label>
      <select
        id="user-select"
        [(ngModel)]="selectedUser"
        class="w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 focus:outline-none dark:border-gray-700 dark:bg-gray-900 dark:text-white"
      >
        <option value="">Select a user</option>
        @for (user of users; track user) {
          <option [value]="user">{{ user }}</option>
        }
      </select>
    </div>
  }

  <div>
    <label for="object-select" class="mb-1 block text-sm font-medium dark:text-white">Object</label>
    <select
      id="object-select"
      [(ngModel)]="selectedObject"
      (ngModelChange)="onObjectChange()"
      class="w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 focus:outline-none dark:border-gray-700 dark:bg-gray-900 dark:text-white"
    >
      <option value="">Select an object</option>
      @for (object of availableObjects; track object.name) {
        <option [value]="object.name">{{ object.name }} ({{ object.type }})</option>
      }
    </select>
  </div>

  <div>
    <label for="role-select" class="mb-1 block text-sm font-medium dark:text-white">Role</label>
    <select
      id="role-select"
      [(ngModel)]="selectedRole"
      (ngModelChange)="onRoleChange()"
      class="w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 focus:outline-none dark:border-gray-700 dark:bg-gray-900 dark:text-white"
    >
      <option value="">Select a role</option>
      @for (role of availableRoles; track role.name) {
        <option [value]="role.name">{{ role.name }}</option>
      }
    </select>
  </div>

  <div modal-footer class="modal-footer">
    <button type="button" (click)="onClose()" class="btn-secondary">Cancel</button>
    <button type="button" (click)="onSave()" [disabled]="!isFormValid()" class="btn-primary">
      {{ isEditMode ? 'Update' : 'Add' }}
    </button>
  </div>
</app-modal>
