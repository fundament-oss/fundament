<div class="card">
  <!-- Header -->
  <div class="card-header">
    <h1 class="text-2xl font-bold dark:text-white">Create new certificate</h1>
    <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">
      Request a new TLS certificate via cert-manager
    </p>
  </div>

  <div class="card-body-lg space-y-6">
    <!-- Basic Information -->
    <div class="card card-body bg-gray-50! dark:bg-gray-900!">
      <h3 class="-mt-2 mb-4 text-lg font-semibold dark:text-white">Basic Information</h3>
      <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
        <div>
          <label for="name" class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300">
            Certificate name *
          </label>
          <input
            id="name"
            type="text"
            [(ngModel)]="name"
            placeholder="E.g. my-tls-cert"
            required
          />
        </div>
        <div>
          <label
            for="namespace"
            class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"
          >
            Namespace *
          </label>
          <select id="namespace" [(ngModel)]="namespace">
            @for (ns of namespaces; track ns) {
              <option [value]="ns">{{ ns }}</option>
            }
          </select>
        </div>
        <div class="sm:col-span-2">
          <label
            for="secretName"
            class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"
          >
            Secret name *
          </label>
          <input
            id="secretName"
            type="text"
            [(ngModel)]="secretName"
            placeholder="E.g. my-tls-secret"
            required
          />
          <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">
            Name of the Kubernetes Secret to store the certificate in
          </p>
        </div>
      </div>
    </div>

    <!-- Issuer -->
    <div class="card card-body bg-gray-50! dark:bg-gray-900!">
      <h3 class="-mt-2 mb-4 text-lg font-semibold dark:text-white">Issuer</h3>
      <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
        <div>
          <label
            for="issuerKind"
            class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"
          >
            Issuer kind *
          </label>
          <select id="issuerKind" [(ngModel)]="issuerKind">
            <option value="ClusterIssuer">ClusterIssuer</option>
            <option value="Issuer">Issuer</option>
          </select>
        </div>
        <div>
          <label
            for="issuerName"
            class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"
          >
            Issuer name *
          </label>
          <select id="issuerName" [(ngModel)]="issuerName">
            <option value="" disabled>Select an issuer</option>
            @for (issuer of filteredIssuers; track issuer.id) {
              <option [value]="issuer.name">{{ issuer.name }} ({{ issuer.type }})</option>
            }
          </select>
        </div>
      </div>
    </div>

    <!-- Subject Alternative Names -->
    <div class="card card-body bg-gray-50! dark:bg-gray-900!">
      <h3 class="-mt-2 mb-4 text-lg font-semibold dark:text-white">Subject Alternative Names</h3>
      <div class="space-y-4">
        <!-- DNS Names -->
        <div>
          <label class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300">
            DNS Names *
          </label>
          <div class="flex gap-2">
            <input
              type="text"
              [(ngModel)]="dnsNameInput"
              placeholder="E.g. example.com"
              (keydown)="onDnsKeydown($event)"
              class="flex-1"
            />
            <button type="button" (click)="addDnsName()" class="btn-light inline-flex items-center">
              <ng-icon name="tablerPlus" class="mr-1" /> Add
            </button>
          </div>
          @if (dnsNames().length > 0) {
            <div class="mt-2 flex flex-wrap gap-1">
              @for (dns of dnsNames(); track dns) {
                <span
                  class="inline-flex items-center rounded-md bg-blue-100 px-2.5 py-1 text-sm font-medium text-blue-800 dark:bg-blue-900/30 dark:text-blue-300"
                >
                  {{ dns }}
                  <button
                    type="button"
                    (click)="removeDnsName(dns)"
                    class="ml-1.5 cursor-pointer text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-200"
                  >
                    <ng-icon name="tablerX" size="0.875rem" />
                  </button>
                </span>
              }
            </div>
          }
        </div>

        <!-- IP Addresses -->
        <div>
          <label class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300">
            IP Addresses
          </label>
          <div class="flex gap-2">
            <input
              type="text"
              [(ngModel)]="ipAddressInput"
              placeholder="E.g. 10.0.0.1"
              (keydown)="onIpKeydown($event)"
              class="flex-1"
            />
            <button
              type="button"
              (click)="addIpAddress()"
              class="btn-light inline-flex items-center"
            >
              <ng-icon name="tablerPlus" class="mr-1" /> Add
            </button>
          </div>
          @if (ipAddresses().length > 0) {
            <div class="mt-2 flex flex-wrap gap-1">
              @for (ip of ipAddresses(); track ip) {
                <span
                  class="inline-flex items-center rounded-md bg-purple-100 px-2.5 py-1 text-sm font-medium text-purple-800 dark:bg-purple-900/30 dark:text-purple-300"
                >
                  {{ ip }}
                  <button
                    type="button"
                    (click)="removeIpAddress(ip)"
                    class="ml-1.5 cursor-pointer text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-200"
                  >
                    <ng-icon name="tablerX" size="0.875rem" />
                  </button>
                </span>
              }
            </div>
          }
        </div>
      </div>
    </div>

    <!-- Duration & Renewal -->
    <div class="card card-body bg-gray-50! dark:bg-gray-900!">
      <h3 class="-mt-2 mb-4 text-lg font-semibold dark:text-white">Duration & Renewal</h3>
      <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
        <div>
          <label
            for="duration"
            class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"
          >
            Duration
          </label>
          <input id="duration" type="text" [(ngModel)]="duration" placeholder="E.g. 2160h" />
          <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">
            E.g. 2160h (90 days). Default: 2160h
          </p>
        </div>
        <div>
          <label
            for="renewBefore"
            class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"
          >
            Renew before
          </label>
          <input
            id="renewBefore"
            type="text"
            [(ngModel)]="renewBefore"
            placeholder="E.g. 720h"
          />
          <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">
            E.g. 720h (30 days). Default: 720h
          </p>
        </div>
      </div>
    </div>

    <!-- Private Key -->
    <div class="card card-body bg-gray-50! dark:bg-gray-900!">
      <h3 class="-mt-2 mb-4 text-lg font-semibold dark:text-white">Private Key</h3>
      <div class="grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4">
        <div>
          <label
            for="algorithm"
            class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"
          >
            Algorithm
          </label>
          <select id="algorithm" [(ngModel)]="algorithm">
            <option value="RSA">RSA</option>
            <option value="ECDSA">ECDSA</option>
            <option value="Ed25519">Ed25519</option>
          </select>
        </div>
        <div>
          <label
            for="keySize"
            class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"
          >
            Size
          </label>
          <select id="keySize" [(ngModel)]="keySize">
            <option value="2048">2048</option>
            <option value="4096">4096</option>
            <option value="256">256 (ECDSA)</option>
            <option value="384">384 (ECDSA)</option>
          </select>
        </div>
        <div>
          <label
            for="encoding"
            class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"
          >
            Encoding
          </label>
          <select id="encoding" [(ngModel)]="encoding">
            <option value="PKCS1">PKCS1</option>
            <option value="PKCS8">PKCS8</option>
          </select>
        </div>
        <div>
          <label
            for="rotationPolicy"
            class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"
          >
            Rotation Policy
          </label>
          <select id="rotationPolicy" [(ngModel)]="rotationPolicy">
            <option value="Never">Never</option>
            <option value="Always">Always</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Actions -->
    <div class="flex gap-2">
      <button type="button" (click)="create()" class="btn-primary">Create certificate</button>
      <a routerLink="/certificates" class="btn-secondary">Cancel</a>
    </div>
  </div>
</div>
