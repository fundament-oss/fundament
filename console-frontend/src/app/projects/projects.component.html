<!-- Loading State -->
@if (isLoading()) {
  <div class="py-12 text-center">
    <div role="status" class="flex justify-center">
      <app-loading-indicator
        class="h-8 w-8 animate-spin fill-indigo-600 text-gray-200 dark:fill-indigo-400 dark:text-gray-800"
      />
      <span class="sr-only">Loading...</span>
    </div>
    <p class="mt-4 text-sm text-gray-600 dark:text-gray-300">Loading projects...</p>
  </div>
}

<!-- Content (only show when not loading) -->
@if (!isLoading()) {
  <div class="card">
    <!-- Header -->
    <div class="card-header">
      <h1 class="text-2xl font-bold dark:text-white">Projects</h1>
    </div>

    <!-- Content -->
    <div class="p-6">
      <!-- Add Project Button -->
      <div class="mb-6">
        <a routerLink="/projects/add" class="btn-primary inline-flex items-center">
          <ng-icon name="tablerPlus" class="mr-1.5" />
          Add project
        </a>
      </div>

      <!-- Projects by Cluster -->
      @if (clusters().length === 0) {
        <p class="text-sm text-gray-500 dark:text-gray-400">
          No clusters found. Create a cluster first to add projects.
        </p>
      } @else {
        <div class="space-y-6">
          @for (cluster of clusters(); track cluster.id) {
            <div>
              <h2 class="mb-3 text-sm font-semibold tracking-wider text-gray-500 uppercase dark:text-gray-400">
                {{ cluster.name }}
              </h2>
              <div
                class="divide-y divide-gray-200 rounded-md border border-gray-200 dark:divide-gray-800 dark:border-gray-800"
              >
                @if (cluster.projects.length === 0) {
                  <div class="px-6 py-6 text-center">
                    <p class="text-sm text-gray-500 dark:text-gray-400">
                      No projects in this cluster.
                    </p>
                  </div>
                } @else {
                  @for (project of cluster.projects; track project.id) {
                    <a
                      [routerLink]="['/projects', project.id]"
                      class="flex items-center justify-between px-6 py-4 hover:bg-gray-50 dark:hover:bg-gray-900"
                    >
                      <div>
                        <h3 class="font-medium dark:text-white">{{ project.name }}</h3>
                      </div>
                      <ng-icon
                        name="tablerChevronRight"
                        size="1.25rem"
                        class="text-gray-400! dark:text-gray-500!"
                      />
                    </a>
                  }
                }
              </div>
            </div>
          }
        </div>
      }
    </div>
  </div>
}
