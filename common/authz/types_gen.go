// Code generated by go generate; DO NOT EDIT.
package authz

import "github.com/google/uuid"

// ObjectType identifies the type of an object (subject or resource).
type ObjectType string

const (
	ObjectTypeUser         ObjectType = "user"
	ObjectTypeOrganization ObjectType = "organization"
	ObjectTypeProject      ObjectType = "project"
	ObjectTypeCluster      ObjectType = "cluster"
	ObjectTypeNodePool     ObjectType = "node_pool"
	ObjectTypeNamespace    ObjectType = "namespace"
	ObjectTypeApiKey       ObjectType = "api_key"
	ObjectTypeInstall      ObjectType = "install"
)

// ActionName identifies the operation being performed.
// These map directly to OpenFGA relations.
type ActionName string

const (
	ActionAdmin            ActionName = "admin"
	ActionViewer           ActionName = "viewer"
	ActionOwner            ActionName = "owner"
	ActionProjectAdmin     ActionName = "project_admin"
	ActionProjectViewer    ActionName = "project_viewer"
	ActionCanView          ActionName = "can_view"
	ActionCanEdit          ActionName = "can_edit"
	ActionCanDelete        ActionName = "can_delete"
	ActionCanManageMembers ActionName = "can_manage_members"
	ActionParent           ActionName = "parent"
	ActionCreator          ActionName = "creator"
	ActionCanUse           ActionName = "can_use"
)

// Object represents an entity in an authorization check (subject or resource).
type Object struct {
	Type       ObjectType
	ID         string
	Properties map[string]any
}

// String formats the object as "type:id" for use in OpenFGA tuples.
func (o Object) String() string {
	return string(o.Type) + ":" + o.ID
}

// Action represents the operation being performed.
type Action struct {
	Name       ActionName
	Properties map[string]any
}

// Context provides additional environmental attributes for the evaluation.
type Context map[string]any

// EvaluationRequest represents a single access evaluation request.
type EvaluationRequest struct {
	Subject  Object
	Resource Object
	Action   Action
	Context  Context
}

// Decision represents the result of an access evaluation.
type Decision struct {
	Decision bool
	Context  Context
}

// EvaluationSemantic defines how batch evaluations are processed.
type EvaluationSemantic string

const (
	// ExecuteAll processes all requests independently (default).
	ExecuteAll EvaluationSemantic = "execute_all"
	// DenyOnFirstDeny stops processing on the first denied request.
	DenyOnFirstDeny EvaluationSemantic = "deny_on_first_deny"
	// PermitOnFirstPermit stops processing on the first permitted request.
	PermitOnFirstPermit EvaluationSemantic = "permit_on_first_permit"
)

// EvaluationsOptions configures batch evaluation behavior.
type EvaluationsOptions struct {
	Semantic EvaluationSemantic
}

// EvaluationsRequest represents a batch of access evaluation requests.
type EvaluationsRequest struct {
	// Default values applied to all evaluations
	Subject  *Object
	Resource *Object
	Action   *Action
	Context  Context

	// Individual evaluations (override defaults)
	Evaluations []EvaluationRequest
	Options     *EvaluationsOptions
}

// EvaluationsResponse contains the results of batch evaluations.
type EvaluationsResponse struct {
	Evaluations []Decision
}

// Object constructors

// User creates an Object of type user.
func User(id uuid.UUID) Object {
	return Object{
		Type: ObjectTypeUser,
		ID:   id.String(),
	}
}

// Organization creates an Object of type organization.
func Organization(id uuid.UUID) Object {
	return Object{
		Type: ObjectTypeOrganization,
		ID:   id.String(),
	}
}

// Project creates an Object of type project.
func Project(id uuid.UUID) Object {
	return Object{
		Type: ObjectTypeProject,
		ID:   id.String(),
	}
}

// Cluster creates an Object of type cluster.
func Cluster(id uuid.UUID) Object {
	return Object{
		Type: ObjectTypeCluster,
		ID:   id.String(),
	}
}

// NodePool creates an Object of type node_pool.
func NodePool(id uuid.UUID) Object {
	return Object{
		Type: ObjectTypeNodePool,
		ID:   id.String(),
	}
}

// Namespace creates an Object of type namespace.
func Namespace(id uuid.UUID) Object {
	return Object{
		Type: ObjectTypeNamespace,
		ID:   id.String(),
	}
}

// ApiKey creates an Object of type api_key.
func ApiKey(id uuid.UUID) Object {
	return Object{
		Type: ObjectTypeApiKey,
		ID:   id.String(),
	}
}

// Install creates an Object of type install.
func Install(id uuid.UUID) Object {
	return Object{
		Type: ObjectTypeInstall,
		ID:   id.String(),
	}
}

// Action constructors

// Admin creates an Action for the admin relation.
func Admin() Action {
	return Action{Name: ActionAdmin}
}

// Viewer creates an Action for the viewer relation.
func Viewer() Action {
	return Action{Name: ActionViewer}
}

// Owner creates an Action for the owner relation.
func Owner() Action {
	return Action{Name: ActionOwner}
}

// ProjectAdmin creates an Action for the project_admin relation.
func ProjectAdmin() Action {
	return Action{Name: ActionProjectAdmin}
}

// ProjectViewer creates an Action for the project_viewer relation.
func ProjectViewer() Action {
	return Action{Name: ActionProjectViewer}
}

// CanView creates an Action for the can_view relation.
func CanView() Action {
	return Action{Name: ActionCanView}
}

// CanEdit creates an Action for the can_edit relation.
func CanEdit() Action {
	return Action{Name: ActionCanEdit}
}

// CanDelete creates an Action for the can_delete relation.
func CanDelete() Action {
	return Action{Name: ActionCanDelete}
}

// CanManageMembers creates an Action for the can_manage_members relation.
func CanManageMembers() Action {
	return Action{Name: ActionCanManageMembers}
}

// Parent creates an Action for the parent relation.
func Parent() Action {
	return Action{Name: ActionParent}
}

// Creator creates an Action for the creator relation.
func Creator() Action {
	return Action{Name: ActionCreator}
}

// CanUse creates an Action for the can_use relation.
func CanUse() Action {
	return Action{Name: ActionCanUse}
}
